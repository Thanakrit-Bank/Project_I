{"ast":null,"code":"import { RedBlackNode } from \"./RedBlackTree\";\nimport { circles, epsilon2 } from \"./Diagram\";\nvar circlePool = [];\nexport var firstCircle;\n\nfunction Circle() {\n  RedBlackNode(this);\n  this.x = this.y = this.arc = this.site = this.cy = null;\n}\n\nexport function attachCircle(arc) {\n  var lArc = arc.P,\n      rArc = arc.N;\n  if (!lArc || !rArc) return;\n  var lSite = lArc.site,\n      cSite = arc.site,\n      rSite = rArc.site;\n  if (lSite === rSite) return;\n  var bx = cSite[0],\n      by = cSite[1],\n      ax = lSite[0] - bx,\n      ay = lSite[1] - by,\n      cx = rSite[0] - bx,\n      cy = rSite[1] - by;\n  var d = 2 * (ax * cy - ay * cx);\n  if (d >= -epsilon2) return;\n  var ha = ax * ax + ay * ay,\n      hc = cx * cx + cy * cy,\n      x = (cy * ha - ay * hc) / d,\n      y = (ax * hc - cx * ha) / d;\n  var circle = circlePool.pop() || new Circle();\n  circle.arc = arc;\n  circle.site = cSite;\n  circle.x = x + bx;\n  circle.y = (circle.cy = y + by) + Math.sqrt(x * x + y * y); // y bottom\n\n  arc.circle = circle;\n  var before = null,\n      node = circles._;\n\n  while (node) {\n    if (circle.y < node.y || circle.y === node.y && circle.x <= node.x) {\n      if (node.L) node = node.L;else {\n        before = node.P;\n        break;\n      }\n    } else {\n      if (node.R) node = node.R;else {\n        before = node;\n        break;\n      }\n    }\n  }\n\n  circles.insert(before, circle);\n  if (!before) firstCircle = circle;\n}\nexport function detachCircle(arc) {\n  var circle = arc.circle;\n\n  if (circle) {\n    if (!circle.P) firstCircle = circle.N;\n    circles.remove(circle);\n    circlePool.push(circle);\n    RedBlackNode(circle);\n    arc.circle = null;\n  }\n}","map":{"version":3,"names":["RedBlackNode","circles","epsilon2","circlePool","firstCircle","Circle","x","y","arc","site","cy","attachCircle","lArc","P","rArc","N","lSite","cSite","rSite","bx","by","ax","ay","cx","d","ha","hc","circle","pop","Math","sqrt","before","node","_","L","R","insert","detachCircle","remove","push"],"sources":["C:/Users/Administrator/Desktop/Project_I/project1/node_modules/d3-voronoi/src/Circle.js"],"sourcesContent":["import {RedBlackNode} from \"./RedBlackTree\";\r\nimport {circles, epsilon2} from \"./Diagram\";\r\n\r\nvar circlePool = [];\r\n\r\nexport var firstCircle;\r\n\r\nfunction Circle() {\r\n  RedBlackNode(this);\r\n  this.x =\r\n  this.y =\r\n  this.arc =\r\n  this.site =\r\n  this.cy = null;\r\n}\r\n\r\nexport function attachCircle(arc) {\r\n  var lArc = arc.P,\r\n      rArc = arc.N;\r\n\r\n  if (!lArc || !rArc) return;\r\n\r\n  var lSite = lArc.site,\r\n      cSite = arc.site,\r\n      rSite = rArc.site;\r\n\r\n  if (lSite === rSite) return;\r\n\r\n  var bx = cSite[0],\r\n      by = cSite[1],\r\n      ax = lSite[0] - bx,\r\n      ay = lSite[1] - by,\r\n      cx = rSite[0] - bx,\r\n      cy = rSite[1] - by;\r\n\r\n  var d = 2 * (ax * cy - ay * cx);\r\n  if (d >= -epsilon2) return;\r\n\r\n  var ha = ax * ax + ay * ay,\r\n      hc = cx * cx + cy * cy,\r\n      x = (cy * ha - ay * hc) / d,\r\n      y = (ax * hc - cx * ha) / d;\r\n\r\n  var circle = circlePool.pop() || new Circle;\r\n  circle.arc = arc;\r\n  circle.site = cSite;\r\n  circle.x = x + bx;\r\n  circle.y = (circle.cy = y + by) + Math.sqrt(x * x + y * y); // y bottom\r\n\r\n  arc.circle = circle;\r\n\r\n  var before = null,\r\n      node = circles._;\r\n\r\n  while (node) {\r\n    if (circle.y < node.y || (circle.y === node.y && circle.x <= node.x)) {\r\n      if (node.L) node = node.L;\r\n      else { before = node.P; break; }\r\n    } else {\r\n      if (node.R) node = node.R;\r\n      else { before = node; break; }\r\n    }\r\n  }\r\n\r\n  circles.insert(before, circle);\r\n  if (!before) firstCircle = circle;\r\n}\r\n\r\nexport function detachCircle(arc) {\r\n  var circle = arc.circle;\r\n  if (circle) {\r\n    if (!circle.P) firstCircle = circle.N;\r\n    circles.remove(circle);\r\n    circlePool.push(circle);\r\n    RedBlackNode(circle);\r\n    arc.circle = null;\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}